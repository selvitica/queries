SELECT 
  LISTAGG(CASE 
            WHEN DATA_TYPE = 'VARCHAR' OR DATA_TYPE = 'CHAR' OR DATA_TYPE = 'TEXT' THEN 'MAX(LENGTH(' || COLUMN_NAME || ')) AS max_length_' || COLUMN_NAME
            WHEN DATA_TYPE = 'TIMESTAMP' THEN 'DATEDIFF(SECOND, MIN(' || COLUMN_NAME || '), MAX(' || COLUMN_NAME || ')) AS max_length_' || COLUMN_NAME
            ELSE 'MAX(' || COLUMN_NAME || ') AS max_length_' || COLUMN_NAME
          END, ',') WITHIN GROUP (ORDER BY ORDINAL_POSITION) AS max_lengths_query
FROM 
  INFORMATION_SCHEMA.COLUMNS
WHERE 
  TABLE_NAME = 'your_table_name'
GROUP BY 
  TABLE_CATALOG, 
  TABLE_SCHEMA, 
  TABLE_NAME;
